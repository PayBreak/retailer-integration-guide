## etika Checkout

When a customer decides to pay for a shopping basket using etika, certain
information from the basket needs to be sent as POST data in order to start the
Checkout process. The customer will then go through our application process. A
the end of our process the customer will have a status (accepted, unsuccessful,
etc.) and will, optionally be returned to the return URL set in the Merchant
Back Office. Future changes to the customers status will be sent via the
Notification Service.

Environment | etika Checkout Address
--- | ---
LIVE | https://checkout.uk.etika.com/
TEST | https://checkout-test.uk.etika.com/

> Please note the https URI scheme and the trailing slash. Using http or
> omitting the trailing slash will return a 301 status; the customer will most
> likely be redirected, but the posted data may be lost.

### Loan Request

The following code illustrates a typical Loan Request. In this example,
we are using `TestInstall` as the Merchant Installation. In this example the
`order_validity` is set to `2014-01-01T12:00:00+00:00`. This indicates that the
stock will be held, and the order will remain valid, until midday on the 1st
January 2014. As the order isn't extendable if a decision for credit has not
been made before then then, or the customer decides not to continue with their
application, the order will expire.

When the customer submits the form, they are directed to etika and can
immediately customise their loan.

Example request:

```html
<form method="post" action="https://checkout-test.uk.etika.com/">

    <input type="hidden" name="checkout_version" value="3.0" />
    <input type="hidden" name="merchant_installation" value="TestInstall" />
    <input type="hidden" name="order_description" value="Computer Equipment" />
    <input type="hidden" name="order_reference" value="011235813" />
    <input type="hidden" name="order_amount" value="21345" />
    <input type="hidden" name="order_validity" value="2014-01-01T12:00:00+00:00" />
    <input type="hidden" name="order_extendable" value="0" />
    <input type="hidden" name="merchant_hash" value="f90da1751785bc2afc3492d2d678b3…" />

    <input type="submit" value="Take a PayBreak" />

</form>
```

> Make sure you convert special characters to HTML entities in your form, e.g. `"`
> should appear as `&quot;`.

For readability the `merchant_hash` has been truncated. Let’s explain those
fields in more detail:

Field | Type | Notes
--- | --- | ---
`checkout_version` | string(3) | Always `3.0`
`merchant_installation` | string(50) |  The Merchant Installation Reference supplied by etika.
`order_reference` | string(50) | This is your own order reference. This must be unique for each request and not change as this will be used in the Merchant Back Office and in any communication with us around this order – e.g. cancellations, fulfillment.
`order_description` | string(50) | Short description of the goods being ordered. This will be shown on the customer’s agreement and will be the default nickname for their loan account. The order description should summarise the order, for example "Computer Equipment" or "Order from website.co.uk" are suitable. This should NOT be a concatenation of the order items.
`order_amount` | int(10) | The total amount to pay in **pence**.
`order_validity` | datetime | ISO 8601 combined date and time representing the time at which you are no longer prepared to hold the order whilst waiting for our initial decision. This must be between 2 and 48 hours in the future at the point the customer arrives at etika’s checkout. Avoid setting your order validity too close to the limits as it will take your customers some time to submit your form. You may also find your time differs to etika’s time.
`order_extendable` | bool | When set to `1` and our initial decision is to refer an application, we will most likely request that the order validity be extended to allow enough time for an underwriter to check the application. Where the order contains time-sensitive items and where extending the order validity would not be suitable you can set this field to `0`. Please be aware that an application that would otherwise be referred would be returned as unsuccessful if the order validity expires outside of normal office hours.
`merchant_hash` | string | The merchant hash is generated by concatenating the following fields: `checkout_version` + `merchant_installation` + `order_amount` + `order_description` + `order_extendable` + `order_reference` + `order_validity`. The concatenated string should then be used with the Shared Secret Key to create a [HMAC-SHA256](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code) message digest which should be represented as lowercase hexadecimal digits. This is identical to the method described in [API Security](#api-security).

All fields are required.

**Deprecation:** The following fields have been deprecated and if provided
their values will be ignored:

Field | Type | Notes
--- | --- | ---
`checkout_type` | string(1) |
`additional_data` | string |
`order_items` | string |

The `checkout_version` field can be sent using the `version` field name. This
method is deprecated.

If any deprecated fields are sent with the request, the `merchant_hash`
concatenation will be based on the following fields: `additional_data`
(if present) + `checkout_type` (if present) + `checkout_version` +
`merchant_installation` + `order_amount` + `order_description` +
`order_extendable` + `order_items` (if present) + `order_reference` +
`order_validity`.
